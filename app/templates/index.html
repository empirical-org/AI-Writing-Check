
<!doctype html>
<html>
<head>
<title>AI Writing Check</title>
<meta charset="utf-8">
<style type="text/css">
* {
    box-sizing: border-box;
}

body {
    font-family: sans-serif;
    margin: 0;
}

a {
    text-decoration: none;
    color: #666;
}

a:hover {
    text-decoration: underline;
}

#container {
    margin: auto;
    width: 960px;
}

#textbox {
    font-family: sans-serif;
    font-size: 12pt;
    width: 100%;
    height: 480px;
    padding: 10px 10px;
    line-height: 1.2f;
}

.bar-row {
    height: 30px;
}
#real-percentage {
    width: 80px;
    vertical-align: top;
}
#bar-container {
    width: 800px;
    background-color: #ff2b28;
    line-height: 0.5;
    position:relative;
    top:6px;
}
#fake-percentage {
    width: 80px;
    vertical-align: top;
}
#bar {
    display: inline-block;
    height: 30px;
    background-color: #00db71;
}
em {
    font-family: monospace;
    font-style: normal;
}
</style>
</head>
<body>
<div id="container">
    <h1>AI Writing Check</h1>
    <h2>A free serviced provided by <a href="https://quill.org">Quill.org</a> to help educators check if a piece of a writing was generated by AI.</h2>
    <p>
        This site uses an open-source model to predict if a piece of writing was generated by AI.
        Approximately 90% of the time it will accurately state that something was written by a human.
    </p>
    <textarea id="textbox" placeholder="Enter text here"></textarea>
    <div><table cellspacing="0" cellpadding="0">
        <tr class="bar-row" style="vertical-align: bottom;">
            <td style="text-align: left;">Human</td>
            <td id="message" style="text-align: center;"></td>
            <td style="text-align: right;">AI</td>
        </tr>
        <tr class="bar-row">
            <td id="real-percentage" style="text-align: left; vertical-align: bottom;"></td>
            <td id="bar-container"><div id="bar" style="width: 50%;"></div></td>
            <td id="fake-percentage" style="text-align: right; vertical-align: bottom;"></td>
        </tr>
    </table></div>
</div>
<script>
let textbox = document.getElementById('textbox');
let last_submit = null;

let real_percentage = document.getElementById('real-percentage');
let fake_percentage = document.getElementById('fake-percentage');
let bar = document.getElementById('bar');
let message = document.getElementById('message');

function update_graph(result) {
    if (result === null) {
        real_percentage.innerHTML = '';
        fake_percentage.innerHTML = '';
        bar.style.width = '50%';
        message.innerHTML = '';
    } else {
        let percentage = result['score']
        let label = result['label']
        if (label == 'Fake') {
            percentage = 1-percentage;
            message.innerHTML = 'This text was likely written by AI.';
        }
        else {
            message.innerHTML = 'This text was likely written by a human.';
        }

        real_percentage.innerHTML = (100 * percentage).toFixed(2) + '%';
        fake_percentage.innerHTML = (100 * (1 - percentage)).toFixed(2) + '%';
        bar.style.width = (100 * percentage).toFixed(2) + '%';
    }
}

textbox.oninput = () => {
    if (last_submit) {
        clearTimeout(last_submit);
    }
    if (textbox.value.length === 0) {
        update_graph(null);
        return;
    }
    message.innerText = 'Predicting ...';
    last_submit = setTimeout(() => {
        let req = new XMLHttpRequest();
        if (textbox.value.length === 0) {
            update_graph(null);
            return;
        }
        <!-- req.open('POST', 'https://us-central1-aiplatform.googleapis.com/v1/projects/591989095106/locations/us-central1/endpoints/8380657946815627264:predict'); -->
        req.open('POST', '/classify');
        <!-- req.setRequestHeader("Authorization", "Bearer " + token) -->
        req.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        req.onreadystatechange = () => {
            if (req.readyState !== 4) return;
            if (req.status !== 200) throw new Error("HTTP status: " + req.status + " " + req.responseText);
            let result = JSON.parse(req.responseText);
            console.log(result)
            update_graph(result);
        };
        <!-- let params = JSON.stringify({ "instances": [{"mimeType": "text/plain", "content": textbox.value}]}); -->
        let params = JSON.stringify({ "instances": [{"data": textbox.value}]});
        console.log(params);
        req.send(params);
    }, 1000);

};

window.addEventListener('DOMContentLoaded', () => {
    textbox.focus();
});
</script>
</body>
</html>
